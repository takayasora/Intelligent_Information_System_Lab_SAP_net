# sequential SAP-net



# ネットワーク描画のテスト
- 作成したいネットワークのつながりを表したクロス表をsqlite3を用いて作成

```python
table_ex = [
    [0, 0.2, 3, 0, 0, 0],
    [0.2, 0, 2, 4, 6, 0],
    [3, 2, 0, 0, 0, 3],
    [0, 4, 0, 0, 0, 0],
    [0, 6, 0, 0, 0, 0],
    [0, 0, 3, 0, 0, 0]
]
```
クロス表内の値が0以上である場合、ノードが繋がっているかつ、その値の距離が設定される

- networkxを用いて空のネットワーク図の作成
- クロス表のつながりを基にノードとエッジを追加



# SQLのテスト
- ネットワーク図の値を保持する必要があるため、SQLiteを介しての値を保持・出力・更新などのテストを行う
  - 値の保持
  
    テーブルを作成したのち、配列（データ）を定義し、データを挿入していく

    ```python
        data = [["Adata",0, 1, 1, 0, 0, 0],
            ["Bdata",1, 0, 1, 1, 1, 0],
            ["Cdata",1, 1, 0, 0, 0, 1],
            ["Ddata",0, 1, 0, 0, 0, 0],
            ["Edata",0, 1, 0, 0, 0, 0],
            ["Fdata",0, 0, 1, 0, 0, 0]]
    ```

    上記のクロス表をテーブルに保持

  - 値の取得
    
    SQLの機能のカーソルを用いて、SQL内のデータを取得し、データフレームへ保持・表示を行う

    データを取得してDataFrameに格納したのち、データを取得・表示


    <img src = "https://i.gyazo.com/aace95992f664bec4cabc7d3ea48ce41.png">

    "data"列をデータフレームのインデックスに設定し、不要な"id"列を削除したのちに、データの表示

    <img src="https://i.gyazo.com/afb0f8222ebc23018bad7f513dfb6b21.png">


# NetworkXとSQLとのデータ送受信テスト
- ネットワーク図の値を保持する必要があるため、SQLiteを介しての値を保持・出力・更新などのテストを行う
  
- 今回のプログラムでは、値の取得を行い、実際にNetworkXを用いて可視化を行っている。
- このプログラムが完成すれば、SQLでデータを保存し、それらを取得、可視化までが完成していることを表す。

- また、NetworkXでの可視化プログラムは、配列の入力からデータフレームの入力に変更している。
  
- 要は、SQLにデータを保持したのち、データを取得し、そのデータの可視化&そのデータを用いてNetworkXでのネットワーク図の作成を行う





# クロス表内の値を変えるテスト
- クロス表内の活性値を更新する
  
  任意のノードを選択し、そのノードに対応する活性値をネットワークのつながりを基に更新する
  ノードiが活性化され、活性値が$a_i$であった場合、隣接するノードjに活性値が拡散されるとき、次式の$\eta_i$の分だけ活性値が伝播する

  更新式
  $\eta_i=\displaystyle\frac{1}{N}A_iexp(-\omega_{ij})$

  - Nはノードが持つパスの数
  - $A_i$は活性値
  - $\omega$はパスの重み（パスの長さ）

  
  <img src = "https://i.gyazo.com/09386be32ad51861b6ffb53206db1fc3.jpg" width = "310">

  
- 上記図のように、ネットワーク内にサイクルが存在する場合
    - ノード$\pi_i$から活性値が拡散されきた重み$\omega_{ij}$と$\omega_{ik}$のパスは、ノード$\pi_j$と$\pi_k$から見れば入力パスであり、その直後の活性値の拡散には用いない。すなわち、$\pi_j$と$\pi_k$は重$\omega_{jk}$のパスを通じて拡散しあう。拡散しあう前に、$\pi_j$と$\pi_k$の活性値を比較し、大きい方から小さいほうに差分計算を行う。

# 活性値の拡散のテスト

- 初めに、全拡散を用いて拡散させていく。また拡散の2重ループ、適当な閾値、拡散の計算式を実装していく。
  - 



